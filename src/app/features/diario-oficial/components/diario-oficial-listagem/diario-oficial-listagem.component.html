<div class="right-column">
  <div class="header d-flex justify-content-between">
    <div class="search-bar">
      <form [formGroup]="filterForm">
        <img
          [src]="secondLogoUrl"
          alt="Logo"
          class="logo"
          (error)="secondLogoUrl = '/app/assets/logos/admin.second.jpg'"
        />
        <div class="input-container">
          <label class="label-ano">Ano</label>
          <input
            type="text"
            placeholder="Selecione o Ano"
            formControlName="year"
            class="form-control"
            bsDatepicker
            [bsConfig]="{
              isAnimated: true,
              minMode: 'year',
              dateInputFormat: 'YYYY'
            }"
          />
        </div>

        <div class="input-container">
          <label>Mês</label>
          <input
            type="text"
            formControlName="month"
            class="form-control"
            bsDatepicker
            [bsConfig]="bsConfig"
            [placeholder]="'Selecione o mês'"
            (bsValueChange)="onMonthSelect($event)"
          />
        </div>
        <div class="input-container">
          <label>Palavra-Chave</label>
          <input
            type="text"
            formControlName="content"
            placeholder="PALAVRA-CHAVE"
          />
        </div>
        <!-- <div class="input-container">
          <label>Período</label>
          <input
            type="text"
            formControlName="periodoInicial"
            placeholder="ÍNICIO"
          />
        </div>
        <div class="input-container">
          <label>até</label>
          <input
            type="text"
            formControlName="periodoFinal"
            placeholder="FINAL"
          />
        </div> -->
        <div class="input-container">
          <label>edição</label>
          <input type="text" formControlName="number" placeholder="SELECIONE" />
        </div>
        <button
          class="btn btn-primary btn-buscar"
          (click)="buscarDiario()"
          type="button"
          aria-label="Pesquisar"
        >
          Buscar
        </button>
        @if(algumCampoClicado()){
        <button
          class="btn mt-4"
          (click)="limparFormulario()"
          type="button"
          aria-label="Limpar"
        >
          <mat-icon>clear</mat-icon>
        </button>
        }
      </form>
      @if (previous_official_gazette_link?.length) {
      <a
        [href]="previous_official_gazette_link"
        target="_blank"
        class="btn-diario-anterior d-flex align-items-center justify-content-center cup"
      >
        <svg
          class="btn-format btn-success"
          fill="#000000"
          version="1.1"
          id="Capa_1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          viewBox="0 0 259.292 259.291"
          xml:space="preserve"
        >
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g
            id="SVGRepo_tracerCarrier"
            stroke-linecap="round"
            stroke-linejoin="round"
          ></g>
          <g id="SVGRepo_iconCarrier">
            <g>
              <g>
                <path
                  d="M149.027,66.505V46.554c0-8.941-4.972-16.973-12.971-20.951c-3.227-1.609-6.83-2.453-10.439-2.453 c-5.053,0-10.061,1.666-14.087,4.711L53.133,71.855c-4.359,2.06-7.95,4.753-10.691,8.073L9.323,104.888 C3.456,109.316-0.03,116.33,0,123.68c0.027,7.335,3.567,14.331,9.463,18.702l102.22,75.84c4.065,3.003,8.887,4.6,13.94,4.6 c3.633,0,7.274-0.87,10.529-2.51c7.95-3.993,12.88-12.01,12.88-20.902v-24.025c24.271,1.988,52.014,12.166,64.228,45.42 c3.375,9.17,12.202,15.337,21.972,15.337c0.828,0,1.682-0.054,2.582-0.138c10.73-1.189,19.209-9.506,20.627-20.207 c0.348-2.654,8.01-65.14-30.247-109.335C209.033,84.345,182.438,70.922,149.027,66.505z M248.449,214.481 c-0.805,6.07-5.657,10.826-11.752,11.499c-0.498,0.054-0.99,0.084-1.471,0.084c-5.53,0-10.568-3.446-12.508-8.731 c-16.754-45.605-59.525-52.409-83.527-52.409c-0.084,0-0.156,0-0.234,0v34.474c0,5.038-2.834,9.638-7.338,11.907 c-4.5,2.27-9.88,1.813-13.939-1.188L15.465,134.287c-3.375-2.51-5.374-6.461-5.392-10.658c-0.012-4.204,1.955-8.164,5.311-10.698 l34.164-25.746c1.771-2.429,4.519-4.786,8.758-6.605l59.285-44.676c4.029-3.038,9.452-3.53,13.964-1.285 c4.537,2.255,7.389,6.884,7.389,11.935v29.015c35.074,2.822,62.492,15.396,81.617,37.485 C256.002,153.983,248.767,212.02,248.449,214.481z"
                ></path>
                <path
                  d="M125.464,101.63c-7.299-0.087-13.178-6.025-13.178-13.33V73.296l-39.397,29.679c-0.841,0.64-1.75,1.162-2.723,1.594 c-0.664,0.805-1.432,1.543-2.282,2.183l-22.209,16.735l66.611,49.423v-20.549c0-6.617,4.846-12.226,11.388-13.192 c0.64-0.09,6.491-0.906,15.51-0.906c17.282,0,51.647,3.267,78.819,26.295c-3.249-11.68-8.695-23.821-17.714-34.186 C184.047,111.7,158.869,102.023,125.464,101.63z M139.185,128.187c-8.581,0-14.619,0.696-16.981,1.015 c-11.406,1.675-19.996,11.644-19.996,23.173v0.516l-39.709-29.456l11.457-8.626c0.829-0.637,1.622-1.324,2.366-2.062 c0.91-0.508,1.796-1.081,2.633-1.715l23.752-17.894c2.219,10.472,11.529,18.453,22.629,18.576 c30.406,0.363,53.068,8.86,67.359,25.289c0.421,0.492,0.847,0.985,1.261,1.496C172.806,129.855,152.083,128.187,139.185,128.187z"
                ></path>
              </g>
            </g>
          </g>
        </svg>
        <div class="d-flex flex-column">
          <span class="ms-1 text-center">Diário Oficial Anterior</span>
          <span class="text-center">{{
            formattedPreviousOfficialGazetteDate
          }}</span>
        </div>
      </a>
      }
    </div>
  </div>
  <div class="table-container">
    <table class="official-docs-table">
      <thead class="thead-fixed">
        <tr>
          <th>EDIÇÃO</th>
          <th>DATA DA PUBLICAÇÃO</th>
          <th>DESCRIÇÃO</th>
          <th>AÇÕES</th>
        </tr>
      </thead>
      @if (publicacoes?.data) { @if(documentos?.data && documentos?.data.length
      > 0){

      <tbody>
        <tr *ngFor="let doc of documentos?.data">
          <td>{{ doc.number }}</td>
          <td>{{ doc.date | date : "dd/MM/yyyy" }}</td>
          <td
            [ngStyle]="{
              'text-align': doc.description.length <= 50 ? 'center' : 'justify'
            }"
          >
            {{ doc.description }}
          </td>
          <td>
            <div class="d-flex">
              @if(doc.audio_url){
              <button class="btn" (click)="togglePlay(doc.audio_url)">
                {{ playingUrl === doc.audio_url ? "⏹️ Parar" : "▶️ Play" }}
              </button>
              }
              <a
                (click)="
                  visualizar(template, doc.file_published, doc.description)
                "
                class="download-link d-flex align-items-center"
              >
                <svg
                  width="21"
                  height="20"
                  viewBox="0 0 21 20"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M9.2187 12.802C9.2187 12.5898 9.2187 12.4454 9.2187 12.2987C9.2187 8.84133 9.2187 5.38391 9.2187 1.92649C9.2187 1.33785 9.56881 0.887073 10.129 0.733896C10.6761 0.585096 11.2559 0.799543 11.5185 1.30065C11.6258 1.50635 11.6805 1.76456 11.6805 1.9987C11.6914 5.48238 11.687 8.96606 11.687 12.4497C11.687 12.5504 11.687 12.6532 11.687 12.8283C11.8752 12.6467 12.0175 12.511 12.1575 12.3753C13.0678 11.4957 13.9737 10.6116 14.8862 9.73413C15.2276 9.40589 15.6828 9.33806 16.0657 9.54156C16.5362 9.79321 16.8053 10.233 16.709 10.6926C16.6675 10.8939 16.5537 11.1083 16.4071 11.2528C14.6608 12.9618 12.9015 14.6599 11.1422 16.3579C10.7351 16.7518 10.1399 16.7453 9.73074 16.3426C7.99328 14.6358 6.2602 12.9246 4.5293 11.2112C4.08071 10.767 4.08727 10.2221 4.5293 9.77789C5.02384 9.27898 5.58841 9.2374 6.05231 9.69036C7.04577 10.6598 8.03048 11.6379 9.01957 12.6117C9.06771 12.6598 9.12023 12.7058 9.22088 12.802H9.2187Z"
                    fill="#3566F3"
                  />
                  <path
                    d="M18.3784 12.3384H20.2121C20.2121 12.439 20.2121 12.5309 20.2121 12.625C20.2121 13.6645 20.2165 14.7039 20.2121 15.7433C20.2012 17.6821 18.6541 19.2882 16.7197 19.297C12.5708 19.3167 8.42188 19.3189 4.27516 19.297C2.33638 19.286 0.791486 17.6711 0.787109 15.7345C0.787109 14.6951 0.787109 13.6557 0.787109 12.6163C0.787109 12.5309 0.787109 12.4456 0.787109 12.3428H2.60991C2.61429 12.4303 2.62085 12.5222 2.62085 12.6141C2.62085 13.6273 2.62085 14.6404 2.62085 15.6536C2.62085 16.7608 3.37361 17.5158 4.47648 17.5158C8.48534 17.5158 12.4942 17.5158 16.503 17.5158C17.63 17.5158 18.3718 16.7718 18.3762 15.647C18.3784 14.6426 18.3762 13.6382 18.3762 12.6338C18.3762 12.5397 18.3762 12.4478 18.3762 12.3406L18.3784 12.3384Z"
                    fill="#3566F3"
                  />
                </svg>
                <div class="text-visualizar">Visualizar</div>
              </a>

              <a class="ms-2 d-flex align-items-center" [href]="doc.file_published" target="_blank">
                <svg
                  height="25px"
                  width="25px"
                  version="1.1"
                  id="_x32_"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  viewBox="0 0 512 512"
                  xml:space="preserve"
                  fill="#000000"
                >
                  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                  <g
                    id="SVGRepo_tracerCarrier"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></g>
                  <g id="SVGRepo_iconCarrier">
                    <style type="text/css">
                      .st0 {
                        fill: #000000;
                      }
                    </style>
                    <g>
                      <path
                        class="st0"
                        d="M378.413,0H208.297h-13.182L185.8,9.314L57.02,138.102l-9.314,9.314v13.176v265.514 c0,47.36,38.528,85.895,85.896,85.895h244.811c47.353,0,85.881-38.535,85.881-85.895V85.896C464.294,38.528,425.766,0,378.413,0z M432.497,426.105c0,29.877-24.214,54.091-54.084,54.091H133.602c-29.884,0-54.098-24.214-54.098-54.091V160.591h83.716 c24.885,0,45.077-20.178,45.077-45.07V31.804h170.116c29.87,0,54.084,24.214,54.084,54.092V426.105z"
                      ></path>
                      <path
                        class="st0"
                        d="M171.947,252.785h-28.529c-5.432,0-8.686,3.533-8.686,8.825v73.754c0,6.388,4.204,10.599,10.041,10.599 c5.711,0,9.914-4.21,9.914-10.599v-22.406c0-0.545,0.279-0.817,0.824-0.817h16.436c20.095,0,32.188-12.226,32.188-29.612 C204.136,264.871,192.182,252.785,171.947,252.785z M170.719,294.888h-15.208c-0.545,0-0.824-0.272-0.824-0.81v-23.23 c0-0.545,0.279-0.816,0.824-0.816h15.208c8.42,0,13.447,5.027,13.447,12.498C184.167,290,179.139,294.888,170.719,294.888z"
                      ></path>
                      <path
                        class="st0"
                        d="M250.191,252.785h-21.868c-5.432,0-8.686,3.533-8.686,8.825v74.843c0,5.3,3.253,8.693,8.686,8.693h21.868 c19.69,0,31.923-6.249,36.81-21.324c1.76-5.3,2.723-11.681,2.723-24.857c0-13.175-0.964-19.557-2.723-24.856 C282.113,259.034,269.881,252.785,250.191,252.785z M267.856,316.896c-2.318,7.331-8.965,10.459-18.21,10.459h-9.23 c-0.545,0-0.824-0.272-0.824-0.816v-55.146c0-0.545,0.279-0.817,0.824-0.817h9.23c9.245,0,15.892,3.128,18.21,10.46 c0.95,3.128,1.62,8.56,1.62,17.93C269.476,308.336,268.805,313.768,267.856,316.896z"
                      ></path>
                      <path
                        class="st0"
                        d="M361.167,252.785h-44.812c-5.432,0-8.7,3.533-8.7,8.825v73.754c0,6.388,4.218,10.599,10.055,10.599 c5.697,0,9.914-4.21,9.914-10.599v-26.351c0-0.538,0.265-0.81,0.81-0.81h26.086c5.837,0,9.23-3.532,9.23-8.56 c0-5.028-3.393-8.553-9.23-8.553h-26.086c-0.545,0-0.81-0.272-0.81-0.817v-19.425c0-0.545,0.265-0.816,0.81-0.816h32.733 c5.572,0,9.245-3.666,9.245-8.553C370.411,256.45,366.738,252.785,361.167,252.785z"
                      ></path>
                    </g>
                  </g>
                </svg>
              </a>
            </div>
          </td>
        </tr>
      </tbody>
      } @else {
      <tbody class="position-relative">
        <tr class="resultado-nao-encontrado">
          Nenhum resultado encontrado
        </tr>
      </tbody>
      } }
    </table>
  </div>
</div>

<ng-template #template>
  <button
    type="button"
    class="btn-format bg-danger m-2 ms-auto"
    aria-label="Close"
    (click)="modalRef?.hide()"
  >
    <span aria-hidden="true" class="text-white font-descricao-modal"
      >&times;</span
    >
  </button>
  <div clas="d-flex flex-row">
    <div class="row altura-modal">
      <div class="col-4 bg-light">
        <h4>Descrição:</h4>
        <p
          class="font-descricao-modal ms-1"
          [ngStyle]="{
            'text-align': documentTitulo.length <= 50 ? 'center' : 'justify'
          }"
        >
          {{ documentTitulo }}
        </p>
      </div>
      <div class="col-8">
        <ngx-extended-pdf-viewer
          filenameForDownload="document_assistech.pdf"
          [showUnverifiedSignatures]="true"
          [src]="documentUrl"
        >
        </ngx-extended-pdf-viewer>
      </div>
    </div>
  </div>
</ng-template>
